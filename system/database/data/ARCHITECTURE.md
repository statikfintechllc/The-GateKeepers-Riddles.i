# Repository Architecture

Last Updated: 2025-12-08T00:18:07.845Z
Generated by: Repo-Mapper Agent

## Overview

**The Gatekeeper's Riddle** - Interactive riddle game with PWA support

- **Total Files**: 44
- **Total Lines**: 12601
- **Primary Language**: JavaScript
- **Architecture**: Frontend web application with service worker

## High-Level Structure

```
The-GateKeepers-Riddles.i/
├── index.html              # Main entry point
├── system/
│   ├── js/                # JavaScript modules
│   │   ├── game.js        # Core game logic
│   │   ├── auth.js        # Authentication
│   │   └── sw.js          # Service worker
│   ├── css/
│   │   └── game.css       # Complete styling
│   ├── riddles/           # Riddle definitions
│   │   ├── riddles.js     # Central registry
│   │   └── *.riddle.js    # Individual riddles
│   ├── database/          # Repository metadata system
│   └── storage/
│       └── manifest.json  # PWA configuration
├── docs/                  # Documentation
└── .github/               # Workflows and automation
```

## Component Breakdown

### UI Layer
- **Files**: 3
- **Purpose**: User interface and visual presentation

Key files:
- index.html
- system/css/game.css
- system/riddle.html

### Logic Layer
- **Files**: 7
- **Purpose**: Application logic and business rules

Key files:
- system/database/cli/repo-db.js
- system/database/lib/database.js
- system/database/lib/migrate.js
- system/database/lib/repo-mapper.js
- system/js/auth.js

### Data Layer
- **Files**: 4
- **Purpose**: Riddle content and data structures

Key files:
- system/riddles/gatekeeper.riddle.js
- system/riddles/mirror.riddle.js
- system/riddles/the-paradox-of-progress.riddle.js
- system/riddles/the-river-that-remembers.riddle.js

### Infrastructure
- **Files**: 16
- **Purpose**: Build tools, workflows, and configuration

### Documentation
- **Files**: 14
- **Purpose**: Project documentation and guides

## Entry Points

### Primary Entry Points
1. **index.html** → Loads game.js and game.css
2. **system/js/game.js** → Initializes application
3. **system/js/sw.js** → Registers service worker

## Dependency Graph

Total Dependencies: 44

### Key Dependencies

- **system/database/cli/repo-db.js** depends on 10 other files
- **system/database/lib/repo-mapper.js** depends on 10 other files
- **system/database/lib/migrate.js** depends on 8 other files
- **system/riddles/riddles.js** depends on 8 other files
- **system/database/lib/database.js** depends on 4 other files

## File Statistics

### By Language
- **JavaScript**: 13 files (34%)
- **Markdown**: 14 files (23%)
- **JSON**: 6 files (21%)
- **HTML**: 2 files (5%)
- **CSS**: 1 files (5%)
- **sql**: 1 files (4%)
- **png**: 1 files (3%)
- **YAML**: 3 files (2%)
- **Shell**: 1 files (1%)
- **Unknown**: 1 files (0%)
- **script**: 1 files (0%)

### By Category
- **UI Files**: 3
- **Logic Files**: 7
- **Data Files**: 4
- **Infrastructure**: 16
- **Documentation**: 14

## Complexity Analysis

### Most Complex Files
1. **system/database/lib/repo-mapper.js** (complexity: 582, functions: 194)
2. **system/js/game.js** (complexity: 212, functions: 136)
3. **system/js/auth.js** (complexity: 82, functions: 48)
4. **system/database/lib/migrate.js** (complexity: 75, functions: 38)
5. **system/database/lib/database.js** (complexity: 44, functions: 20)
6. **system/database/cli/repo-db.js** (complexity: 40, functions: 36)
7. **system/js/sw.js** (complexity: 10, functions: 8)
8. **system/riddles/riddles.js** (complexity: 3, functions: 2)
9. **.github/ISSUE_TEMPLATE/mapper_request.md** (complexity: 0, functions: 0)
10. **.github/ISSUE_TEMPLATE/riddle_request.md** (complexity: 0, functions: 0)

### Function Distribution
- **Total Functions**: 482
- **Exported Functions**: 32
- **Async Functions**: 4
- **Average Complexity**: 4.34

## Design Patterns

### Architecture Patterns
1. **Module Pattern**: Used throughout for encapsulation
2. **Registry Pattern**: riddles.js acts as central registry
3. **Observer Pattern**: Event listeners for UI interactions
4. **Service Worker Pattern**: Offline-first PWA

### Code Organization
- Separation of concerns (UI, logic, data)
- Modular structure with clear dependencies
- Template-based riddle creation

## Extension Points

### Adding New Riddles
1. Create new `.riddle.js` file using template
2. Register in `riddles.js`
3. Follow standardized format

### Adding New Features
- **UI Extensions**: Modify game.js and game.css
- **Data Extensions**: Extend riddle template
- **Infrastructure**: Add to workflows or database

## Database Schema

The repository uses a comprehensive SQLite database for metadata:

### Core Tables
- **repository_metadata**: Repository configuration
- **files**: File metadata and statistics (44 entries)
- **functions**: Function definitions and metrics (482 entries)
- **dependencies**: File-to-file dependencies (44 entries)
- **scan_history**: Audit trail of all scans

### Queries Available
- Full-text search across files and functions
- Dependency graph traversal
- Complexity reports
- Language statistics

## Maintenance

### Code Quality
- Average file complexity: 23.82
- Average function complexity: 4.34

### Technical Debt
- 6 files have high complexity (>20)
- 4 files are very large and may benefit from refactoring

---

*Generated by Repo-Mapper Agent using AI-powered code analysis*
*Database System: SQLite with full-text search (FTS5)*
